!function(){if("object"!=typeof JSON){JSON={};var e,t,n,r,i=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,u=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,a=/(?:^|:|,)(?:\s*\[)+/g,l=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":"Invalid Date"}),"function"!=typeof JSON.stringify&&(n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(n,i,o){var u;if(e="",t="","number"==typeof o)for(u=0;u<o;u+=1)t+=" ";else"string"==typeof o&&(t=o);if(r=i,i&&"function"!=typeof i&&("object"!=typeof i||"number"!=typeof i.length))throw new Error("JSON.stringify");return str("",{"":n})}),"function"!=typeof JSON.parse&&(JSON.parse=function(e,t){var n;function walk(e,n){var r,i,o=e[n];if(o&&"object"==typeof o)for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&((i=walk(o,r))!==undefined?o[r]=i:delete o[r]);return t.call(e,n,o)}if(e=String(e),c.lastIndex=0,c.test(e)&&(e=e.replace(c,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),i.test(e.replace(o,"@").replace(u,"]").replace(a,"")))return n=Function("return ("+e+")")(),"function"==typeof t?walk({"":n},""):n;throw new Error("JSON.parse")})}function f(e){return e<10?"0"+e:e}function quote(e){return l.lastIndex=0,l.test(e)?'"'+e.replace(l,(function(e){var t=n[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function str(n,i){var o,u,a,l,c,s=e,p=i[n];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(n)),"function"==typeof r&&(p=r.call(i,n,p)),typeof p){case"string":return quote(p);case"number":return isFinite(p)?String(p):"null";case"boolean":return String(p);case"object":if(!p)return"null";if(e+=t,c=[],"[object Array]"===Object.prototype.toString.apply(p)){for(l=p.length,o=0;o<l;o+=1)c[o]=str(String(o),p)||"null";return a=0===c.length?"[]":e?"[\n"+e+c.join(",\n"+e)+"\n"+s+"]":"["+c.join(",")+"]",e=s,a}if(r&&"object"==typeof r)for(l=r.length,o=0;o<l;o+=1)"string"==typeof r[o]&&(a=str(u=String(r[o]),p))&&c.push(quote(u)+(e?": ":":")+a);else for(u in p)Object.prototype.hasOwnProperty.call(p,u)&&(a=str(u,p))&&c.push(quote(u)+(e?": ":":")+a);return a=0===c.length?"{}":e?"{\n"+e+c.join(",\n"+e)+"\n"+s+"}":"{"+c.join(",")+"}",e=s,a}return"null"}}();var e,t,n,r,hasArg=function(e){return 0!==PPx.Arguments.length&&PPx.Argument(0)===e},i={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},useLanguage=function(){var e=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===e||"ja"===e?e:i.language},o=PPx.CreateObject("Scripting.FileSystemObject"),expandNlCode=function(e){var t="\n",n=e.indexOf("\r");return~n&&(t="\r\n"==e.substring(n,n+2)?"\r\n":"\r"),t},isCV8=function(){return"ClearScriptV8"===PPx.ScriptEngineName},hexToNum=function(e){var t=parseInt(e,16);return isNaN(t)?undefined:t},isEmptyStr=function(e){return""===e},isBottom=function(e){return null==e},u={TypeToCode:{crlf:"\r\n",cr:"\r",lf:"\n"},CodeToType:{"\r\n":"crlf","\r":"cr","\n":"lf"},Ppx:{lf:"%%bl",cr:"%%br",crlf:"%%bn",unix:"%%bl",mac:"%%br",dos:"%%bn","\n":"%%bl","\r":"%%br","\r\n":"%%bn"},Ascii:{lf:"10",cr:"13",crlf:"-1",unix:"10",mac:"13",dos:"-1","\n":"10","\r":"13","\r\n":"-1"}},exec=function(e,t){try{var n;return[!1,null!=(n=t())?n:""]}catch(r){return[!0,""]}finally{e.Close()}},read=function(e){var t=e.path,n=e.enc,r=void 0===n?"utf8":n;if(!o.FileExists(t))return[!0,t+" not found"];var i=o.GetFile(t);if(0===i.Size)return[!0,t+" has no data"];var u=!1,a="";if("utf8"===r){var l=PPx.CreateObject("ADODB.Stream"),c=exec(l,(function(){return l.Open(),l.Charset="UTF-8",l.LoadFromFile(t),l.ReadText(-1)}));u=c[0],a=c[1]}else{var s="utf16le"===r?-1:0,p=i.OpenAsTextStream(1,s),d=exec(p,(function(){return p.ReadAll()}));u=d[0],a=d[1]}return u?[!0,"Unable to read "+t]:[!1,a]},readLines=function(e){var t,n=e.path,r=e.enc,i=void 0===r?"utf8":r,o=e.linefeed,u=read({path:n,enc:i}),a=u[0],l=u[1];if(a)return[!0,l];o=null!=(t=o)?t:expandNlCode(l.slice(0,1e3));var c=l.split(o);return isEmptyStr(c[c.length-1])&&c.pop(),[!1,{lines:c,nl:o}]},writeLines=function(e){var t=e.path,n=e.data,r=e.enc,a=void 0===r?"utf8":r,l=e.append,c=void 0!==l&&l,s=e.overwrite,p=void 0!==s&&s,d=e.linefeed,g=void 0===d?i.nlcode:d;if(!p&&!c&&o.FileExists(t))return[!0,t+" already exists"];var h,v=o.GetParentFolderName(t);if(o.FolderExists(v)||PPx.Execute("*makedir "+v),"utf8"===a){if(isCV8()){var x=n.join(g),b=c?"AppendAllText":"WriteAllText";return[!1,NETAPI.System.IO.File[b](t,x)]}var y=p||c?2:1,O=PPx.CreateObject("ADODB.Stream");h=exec(O,(function(){O.Open(),O.Charset="UTF-8",O.LineSeparator=Number(u.Ascii[g]),c?(O.LoadFromFile(t),O.Position=O.Size,O.SetEOS):O.Position=0,O.WriteText(n.join(g),1),O.SaveToFile(t,y)}))[0]}else{var S=c?8:p?2:1;o.FileExists(t)||PPx.Execute("%Osq *makefile "+t);var P="utf16le"===a?-1:0,j=o.GetFile(t).OpenAsTextStream(S,P);h=exec(j,(function(){j.Write(n.join(g)+g)}))[0]}return h?[!0,"Could not write to "+t]:[!1,""]},a={en:{couldNotRead:"Could not read _iconlist",failedRegisters:"Failed"},ja:{couldNotRead:"_iconlistを読み込めませんでした",failedRegisters:"登録失敗"}};Object.keys||(Object.keys=(e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),r=(n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(i){if("function"!=typeof i&&("object"!=typeof i||null==i))throw new TypeError("Object.keys: called on non-object");var o,u,a=[];for(o in i)e.call(i,o)&&a.push(o);if(t)for(u=0;u<r;u++)e.call(i,n[u])&&a.push(n[u]);return a}));var properties=function(e){for(var t=PPx.Extract("%*getcust("+e+")").split(i.nlcode),n={},r=/^([^,=]+)([,=])\s*(.*)/,o="",u=1,a=t.length-2;u<a;u++){""!==t[u].replace(r,(function(e,t,r,i){return o=t.replace(/[\s\uFEFF\xA0]+$/,""),n[o]={sep:r,value:[i]},""}))&&n[o].value.push(t[u].replace(/^\s*/,""))}return n},l="[group]",c="[endgroup]",s="[ext]",p="[endext]",getIcons=function(e){for(var t={},n={},r=[],i=/^(\S+)[\s=]+(.+)$/,o=0,u=e.length;o<u;o++){var a=e[o];if(0!==a.indexOf(l)){if(0===a.indexOf(s))for(;o<u;o++){var d=e[o];if(0===d.indexOf(p))break;0!==d.indexOf(";")&&d.replace(i,(function(e,t,i){var o=0===i.indexOf("x")?"u"+hexToNum(i.substring(1)):i,u=t.toUpperCase();return isBottom(o)?r.push(u):n[u]=o,""}))}}else for(;o<u;o++){var g=e[o];if(0===g.indexOf(";")||0===g.indexOf(c))break;g.replace(i,(function(e,n,r){return t[n.toUpperCase()]=r.split(",")}))}}for(var h=0,v=Object.keys(t);h<v.length;h++)for(var x=v[h],b=0,y=t[x];b<y.length;b++){var O=y[b],S=n[x];S&&(n[O.toUpperCase()]=S)}return{icons:n,errors:r}},getCmdlines=function(e,t){for(var n=properties("C_ext"),r=["X_icnl\t= {"],i=[],o="",u=0,a=Object.keys(t);u<a.length;u++){var l=a[u],c=n[l]?"c'"+n[l].value+"'":"";"*"===l?o="*setcust X_icnl:"+l+"=<f'"+e+"'"+c+t[l]+">":i.push("*setcust X_icnl:"+l+"=<f'"+e+"'"+c+t[l]+">"),r.push("-|"+l+" =")}return r.push("}"),isEmptyStr(o)||i.push(o),{cmdlines:i,unset:r}},d=a[useLanguage()];(function(){var e="\r\n",t=hasArg("1"),n=PPx.Extract("%sgu'ppmcache'"),r=n+"\\ppm\\unset\\ppm-iconicfont.cfg",i=readLines({path:n+"\\list\\_iconlist",enc:"utf8",linefeed:"\n"}),o=i[0],u=i[1];o&&(PPx.Echo(d.couldNotRead),PPx.Quit(-1));var a=PPx.Extract("%*getcust(S_ppm#user:iconicfont)"),l=getIcons(u.lines),c=l.icons,s=l.errors,p=getCmdlines(a,c),g=p.cmdlines,h=p.unset,v=s.length>0?[""+e+d.failedRegisters+": "+s.join(",")]:[];if(g.length>0){PPx.Execute(g.join("%:"));var x=writeLines({path:r,data:h,enc:"utf8",overwrite:!0,linefeed:"\n"}),b=x[0],y=x[1];b&&v.push(e,y)}t&&PPx.report(v.join(e))})();
